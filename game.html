<!DOCTYPE html>

<script>
  // This function returns a randomly chosen state for the computer
  function getComputerChoice() {
    const choices = ['rock', 'paper', 'scissors'];
    let randomNum = Math.floor(Math.random() * 3);
    return choices[randomNum];
  }

  // This function checks if the player inputted a valid selection. Otherwise, returns error message
  function validatePlayerSelection(playerSelection) {
    playerSelection = playerSelection.toLowerCase();
    const validSelections = ['rock', 'paper', 'scissors'];
    return validSelections.includes(playerSelection);
  }

  // This function plays one round of the game between the player and the computer
  function evaluateOneRound(playerSelection, computerSelection) {
    playerSelection = playerSelection.toLowerCase();

    if ((computerSelection == "rock" && playerSelection == "paper") ||
        (computerSelection == "paper" && playerSelection == "scissors") ||
        (computerSelection == "scissors" && playerSelection == "rock")) {
          return "You win!";
        }
    else if (computerSelection === playerSelection) {
      return "Tie!";
    } else {
      return "You lose.";
    }
  }

  // This function actually plays the round, and repeats a round in the case of ties
  function playGame() {
    let i = 0;
    let playerScore = 0;
    let computerScore = 0;
    do {
      let playerSelection = prompt("Pick: Rock, Paper, or Scissors?");
      // Check for validity
      if (! validatePlayerSelection(playerSelection)) {
        console.log("You entered an invalid input. Please enter a new input.");
        continue;
      };
      let computerSelection = getComputerChoice();
      let result = evaluateOneRound(playerSelection, computerSelection);
      console.log(`Computer chose ${computerSelection}. You, player, chose ${playerSelection}. ` + result);
      if (result === "You win!") {
        playerScore += 1;
        i++;
      } else if (result === "You lose.") {
        computerScore += 1;
        i++;
      } 
    } while (i < 5);

    console.log(`Your score is ${playerScore}. The computer's score is ${computerScore}.`);
  }

  // Main
  playGame();


</script>